<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Country Medal Details</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <a href="index.html"><img class="imga" src="img/olimpiada-olympic-games-logo-0.png" alt="Simbolo Olímpico"></a>
        <h1 id="countryName"></h1>
        <nav><ul>
            <li><a href="index.html">Início</a></li>
            <li><a href="about.html">Sobre</a></li>
        </ul></nav>
        
    </header>
    <main>
        <img id="countryFlag" alt="Country Flag" style="width: 100px;">
        <p>Total Medals through all Olympics:</p>
        <ul>
            <li>Gold: <span id="goldMedals"></span></li>
            <li>Silver: <span id="silverMedals"></span></li>
            <li>Bronze: <span id="bronzeMedals"></span></li>
            <li>Total: <span id="totalMedals"></span></li>
        </ul>
        <h2>About <span id="countryNameDescription"></span></h2>
        <p id="countryDescription"></p>
        <h2>Notable Olympic Athletes</h2>
        <div id="athletesImages" style="margin-bottom: 50px;"></div>
    </main>
    <footer>
        
    </footer>
    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            const countryData = JSON.parse(localStorage.getItem('countryData'));
            if (countryData) {
                document.getElementById('countryName').textContent = countryData.country;
                document.getElementById('countryNameDescription').textContent = countryData.country;
                document.getElementById('goldMedals').textContent = countryData.gold;
                document.getElementById('silverMedals').textContent = countryData.silver;
                document.getElementById('bronzeMedals').textContent = countryData.bronze;
                document.getElementById('totalMedals').textContent = countryData.total;
                document.getElementById('countryFlag').src = countryData.flag;

                try {
                    const response = await fetch(`https://en.wikipedia.org/api/rest_v1/page/summary/${countryData.country}`);
                    const data = await response.json();
                    if (data.extract) {
                        document.getElementById('countryDescription').textContent = data.extract;
                    } else {
                        document.getElementById('countryDescription').textContent = 'Description not available.';
                    }
                } catch (error) {
                    document.getElementById('countryDescription').textContent = 'Failed to fetch description.';
                }

                const athletesImagesContainer = document.getElementById('athletesImages');
                console.log("Something", countryData);
                for (const athlete of countryData.country) {
                    try {
                        const response = await fetch(`https://en.wikipedia.org/api/rest_v1/page/summary/${athlete}`);
                        const data = await response.json();
                        if (data.thumbnail && data.thumbnail.source) {
                            const athleteContainer = document.createElement('div');
                            athleteContainer.style.display = 'inline-block';
                            athleteContainer.style.margin = '10px';
                            athleteContainer.style.textAlign = 'center';
                            
                            const img = document.createElement('img');
                            img.src = data.thumbnail.source;
                            img.alt = athlete;
                            img.style.width = '100px';
                            img.style.display = 'block';
                            img.style.margin = '0 auto';
                            
                            const link = document.createElement('a');
                            link.href = `https://en.wikipedia.org/wiki/${athlete}`;
                            link.target = '_blank';
                            link.style.textDecoration = 'none';
                            
                            const name = document.createElement('p');
                            name.textContent = athlete;
                            name.style.color = 'gray';
                            name.style.fontStyle = 'italic';
                            name.style.marginTop = '5px';
                            
                            link.appendChild(name);
                            athleteContainer.appendChild(img);
                            athleteContainer.appendChild(link);
                            athletesImagesContainer.appendChild(athleteContainer);
                        }
                    } catch (error) {
                        console.error(`Failed to fetch image for ${athlete}:`, error);
                    }
                }
            } else {
                document.body.innerHTML = '<p>Error: No country data found.</p>';
            }
        });
    </script>
    <footer>
        <div class="footer-cont">
            <p>&copy; 2024 Ranking Olímpico de Medalhas. Todos os direitos reservados.</p>
            <nav>
                <ul>
                    <li><a href="">Política de Privacidade</a></li>
                    <li><a href="">Termos de Uso</a></li>
                    <li><a href="">Contato</a></li>
                </ul>
            </nav>
        </div>
    </footer>
</body>
</html>
